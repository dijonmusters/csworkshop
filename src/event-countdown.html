<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/paper-styles/typography.html">
<link rel="import" href="../bower_components/timer-days/timer-days.html">
<link rel="import" href="../bower_components/paper-card/paper-card.html">
<script src="../bower_components/moment/moment.js"></script>

<dom-module id="event-countdown">
  <template>
    <style include="shared-styles">
      paper-card {
        background: linear-gradient(-45deg, #EE7752, #E73C7E, #23A6D5, #23D5AB);
        background-size: 400% 400%;
        -webkit-animation: Gradient 15s ease infinite;
        -moz-animation: Gradient 15s ease infinite;
        animation: Gradient 15s ease infinite;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        cursor: default;
        border-radius: 8px;
      }

      @-webkit-keyframes Gradient {
        0% {
          background-position: 0% 50%
        }
        50% {
          background-position: 100% 50%
        }
        100% {
          background-position: 0% 50%
        }
      }

      @-moz-keyframes Gradient {
        0% {
          background-position: 0% 50%
        }
        50% {
          background-position: 100% 50%
        }
        100% {
          background-position: 0% 50%
        }
      }

      @keyframes Gradient {
        0% {
          background-position: 0% 50%
        }
        50% {
          background-position: 100% 50%
        }
        100% {
          background-position: 0% 50%
        }
      }

      h1 {
        font-family: 'Open Sans';
        font-weight: 500;
        text-align: center;
        top: 45%;
        right: 0;
        left: 0;
        color: white;
      }

      paper-card {
        width: 100%;
      }

      paper-card p {
        text-align: center;
      }

      [hidden] {
        display: none !important;
      }

      timer-days {
        box-shadow: 0 0px 0px #333;
        --timer-days-border-color: transparent;
        --timer-days-background-color: transparent;
        --timer-days-hover-background-color: transparent;
        --timer-days-hover-border-color: transparent;
        --timer-days-hover-font-color: white;
        --timer-days-font-color: white;
        --timer-days-font-number-size: 5em;
        font-family: 'Share Tech Mono', 'Roboto';
        letter-spacing: 1.25em;
        margin: 16px auto;
        min-width: 0px;
      }
    </style>
    <paper-card>
      <div class="card-content">
        <h1 id="welcomeText"></h1>
        <timer-days hidden$=[[shouldHideCountdown]] target-date="[[targetDate]]"></timer-days>

      </div>
    </paper-card>

  </template>

  <script>
    (function () {
      Polymer({
        is: 'event-countdown',

        properties: {
          targetDate: {
            type: String,
            value: "2018-09-11T16:40:00",
            observer: 'shouldHideCount'
          },
          shouldHideCountdown: {
            type: Boolean
          }
        },

        getWelcomeText: function () {
          if (moment().isBefore(moment(this.targetDate), 'day')) {
            return "Join us for two days of sharing, learning and networking with fellow educators."
          }
          else if (moment().isSame(moment(this.targetDate), 'day')) {
            return "Welcome to Deakin ITCO Workshop."
          }
          else if (moment().isAfter(moment(this.targetDate), 'day')) {
            return "Welcome back to Deakin ITCO Workshop."
          }
        },

        shouldHideCount: function () {
          // now in user's local time zone
          var now = moment();

          // Gets event time zone and sets to Melbourne time zone
          var eventDate = moment(this.targetDate);
          eventDate.utcOffset(600);

          return now.isSameOrAfter(eventDate, 'day')
        },

        ready: function () {
          this.$.welcomeText.textContent = this.getWelcomeText();
          this.shouldHideCountdown = this.shouldHideCount();
        }
      });
    })();
  </script>
</dom-module>